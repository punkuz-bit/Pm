---
import Base from "../../layouts/Base.astro";

export async function getStaticPaths() {
  const modules = import.meta.glob('../../../content/articles/*.mdx');
  // Build static paths: /articles/<slug>
  return Object.keys(modules).map((filepath) => {
    const slug = filepath.split('/').pop()?.replace('.mdx','') || '';
    return { params: { slug } };
  });
}

// Load the one that matches this slug
const modules = import.meta.glob('../../../content/articles/*.mdx');
const entry = Object.entries(modules).find(([path]) => path.endsWith(`${Astro.params.slug}.mdx`));

if (!entry) {
  throw new Error(`Article not found for slug: ${Astro.params.slug}`);
}

const mod: any = await entry[1]();
const { Content, frontmatter } = mod;
const { title, description, date, tags = [], linkedin = '' } = frontmatter || {};
---

<Base title={title} description={description}>
  <div class="max-w-3xl mx-auto px-4 py-10">
    <p><a href="/articles" class="text-indigo underline">← Back to Articles</a></p>
    <h1 class="text-3xl font-bold mt-2">{title}</h1>
    <div class="text-sm text-gray-500">{date}</div>

    {linkedin && (
      <div class="mt-4">
        <a class="btn-gold" href={linkedin} target="_blank" rel="noopener">Read on LinkedIn →</a>
      </div>
    )}
{frontmatter.thumb && (
  <div class="mt-5 rounded-xl overflow-hidden border border-white/15">
    <img src={frontmatter.thumb} alt={title} class="w-full h-[240px] md:h-[320px] object-cover" />
  </div>
)}

    <div class="prose max-w-none mt-6">
      <Content />
    </div>

    {linkedin && (
      <div class="mt-8">
        <a class="btn-gold" href={linkedin} target="_blank" rel="noopener">Continue on LinkedIn →</a>
      </div>
    )}
  </div>
<style>
  .btn-gold{
    display:inline-block; padding:.6rem 1.1rem; border-radius:.75rem;
    font-weight:700; border:1px solid var(--pm-gold);
    background: var(--pm-gold); color:#0b0d16;
  }
  .btn-gold:hover{opacity:.9}
  /* Make links inside the MDX body readable */
  .prose a { color: var(--pm-gold); text-decoration: underline; }
</style>

</Base>
